:8080 {
  root * /usr/share/nginx/html
  encode gzip zstd
  file_server

  # API Proxying
  reverse_proxy /query* web-api:8000
  reverse_proxy /check-json-files* web-api:8000
  reverse_proxy /docs* web-api:8000
  reverse_proxy /messages* mcp-server:8050
  reverse_proxy /sse* mcp-server:8050

  # SPA Fallback for React
  @notAPI {
    not path /query* /check-json-files* /docs* /messages* /sse*
  }
  handle @notAPI {
    try_files {path} /index.html
  }

  log {
    output stdout
    format console
  }
}